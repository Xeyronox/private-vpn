name: "Enhanced VPN Security Configuration"

disable-default-queries: false

queries:
  - name: security-extended
    uses: security-extended
  - name: security-and-quality
    uses: security-and-quality
  - name: custom-security
    uses: ./.github/codeql/custom-queries/

paths-ignore:
  - node_modules
  - dist
  - build
  - '**/*.min.js'
  - '**/*.bundle.js'
  - public/assets
  - '**/*.d.ts'

paths:
  - src
  - scripts
  - '*.ts'
  - '*.tsx'
  - '*.js'
  - '*.jsx'

packs:
  - codeql/javascript-queries
  - codeql/security-queries

# VPN-specific security configurations
query-filters:
  - include:
      kind:
        - problem
        - path-problem
      severity:
        - error
        - warning
      security-severity:
        - critical
        - high
        - medium
      tags:
        - security
        - external/cwe/cwe-079  # Cross-site scripting
        - external/cwe/cwe-089  # SQL injection
        - external/cwe/cwe-090  # LDAP injection
        - external/cwe/cwe-094  # Code injection
        - external/cwe/cwe-116  # Improper encoding/escaping
        - external/cwe/cwe-117  # Log injection
        - external/cwe/cwe-200  # Information exposure
        - external/cwe/cwe-209  # Information exposure through error messages
        - external/cwe/cwe-295  # Certificate validation
        - external/cwe/cwe-327  # Weak cryptography
        - external/cwe/cwe-338  # Weak PRNG
        - external/cwe/cwe-352  # CSRF
        - external/cwe/cwe-377  # Insecure temporary file
        - external/cwe/cwe-400  # Resource exhaustion
        - external/cwe/cwe-434  # Unrestricted file upload
        - external/cwe/cwe-502  # Deserialization of untrusted data
        - external/cwe/cwe-611  # XXE
        - external/cwe/cwe-770  # Resource allocation without limits
        - external/cwe/cwe-776  # XML external entity reference
        - external/cwe/cwe-798  # Hard-coded credentials
        - external/cwe/cwe-829  # Local file inclusion
        - external/cwe/cwe-918  # SSRF